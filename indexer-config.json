{
  "name": "codebase-indexer",
  "description": "Code repository indexer with AI enrichment for automated ingestion",
  "dataSourceName": "codebase-blob-datasource",
  "targetIndexName": "codebase-mcp-sota",
  "skillsetName": "codebase-skillset",
  "schedule": {
    "interval": "PT1H",
    "startTime": "2025-01-01T00:00:00Z"
  },
  "parameters": {
    "batchSize": 50,
    "maxFailedItems": 10,
    "maxFailedItemsPerBatch": 5,
    "configuration": {
      "dataToExtract": "contentAndMetadata",
      "parsingMode": "default",
      "imageAction": "none",
      "excludedFileNameExtensions": ".exe,.dll,.obj,.pdb,.class,.jar,.bin,.so,.dylib",
      "indexedFileNameExtensions": ".py,.js,.ts,.java,.cs,.cpp,.c,.h,.go,.rs,.rb,.php,.swift,.kt,.scala,.r,.m,.mm,.json,.yaml,.yml,.md,.txt,.sql",
      "failOnUnprocessableDocument": false,
      "failOnUnsupportedContentType": false,
      "indexStorageMetadataOnlyForOversizedDocuments": true
    }
  },
  "fieldMappings": [
    {
      "sourceFieldName": "metadata_storage_path",
      "targetFieldName": "file_path",
      "mappingFunction": {
        "name": "urlDecode"
      }
    },
    {
      "sourceFieldName": "metadata_storage_name",
      "targetFieldName": "title"
    },
    {
      "sourceFieldName": "metadata_storage_last_modified",
      "targetFieldName": "last_modified"
    },
    {
      "sourceFieldName": "metadata_storage_size",
      "targetFieldName": "size_bytes"
    },
    {
      "sourceFieldName": "metadata_storage_content_type",
      "targetFieldName": "file_extension",
      "mappingFunction": {
        "name": "extractTokenAtPosition",
        "parameters": {
          "delimiter": "/",
          "position": 1
        }
      }
    },
    {
      "sourceFieldName": "content",
      "targetFieldName": "content"
    }
  ],
  "outputFieldMappings": [
    {
      "sourceFieldName": "/document/pages/*",
      "targetFieldName": "code_content"
    },
    {
      "sourceFieldName": "/document/vector/*",
      "targetFieldName": "content_vector"
    },
    {
      "sourceFieldName": "/document/language",
      "targetFieldName": "language"
    },
    {
      "sourceFieldName": "/document/keyPhrases/*",
      "targetFieldName": "intent_keywords"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/functions/*",
      "targetFieldName": "function_name"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/classes/*",
      "targetFieldName": "class_name"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/imports",
      "targetFieldName": "imports"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/dependencies",
      "targetFieldName": "dependencies"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/docstring",
      "targetFieldName": "docstring"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/signature",
      "targetFieldName": "signature"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/comments",
      "targetFieldName": "comments"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/framework",
      "targetFieldName": "framework"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/complexity",
      "targetFieldName": "complexity_score"
    },
    {
      "sourceFieldName": "/document/codeAnalysis/patterns",
      "targetFieldName": "detected_patterns"
    },
    {
      "sourceFieldName": "/document/gitMetadata/branch",
      "targetFieldName": "git_branch"
    },
    {
      "sourceFieldName": "/document/gitMetadata/commit",
      "targetFieldName": "git_commit"
    },
    {
      "sourceFieldName": "/document/gitMetadata/authors",
      "targetFieldName": "git_authors"
    },
    {
      "sourceFieldName": "/document/gitMetadata/commitCount",
      "targetFieldName": "git_commit_count"
    },
    {
      "sourceFieldName": "/document/gitMetadata/lastModified",
      "targetFieldName": "git_last_modified"
    }
  ]
}
