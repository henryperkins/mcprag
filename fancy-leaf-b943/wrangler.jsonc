/**
 * For more details on how to configure Wrangler, refer to:
 * https://developers.cloudflare.com/workers/wrangler/configuration/
 */
{
	"$schema": "node_modules/wrangler/config-schema.json",
	"name": "fancy-leaf-b943",
	"main": "worker/index.ts",
	"compatibility_date": "2025-08-06",
	"assets": {
		"directory": "./dist/client",
		"not_found_handling": "single-page-application"
	},
	"observability": {
		"enabled": true
	},
	/**
	 * Smart Placement
	 * Docs: https://developers.cloudflare.com/workers/configuration/smart-placement/#smart-placement
	 */
	// "placement": { "mode": "smart" }
	/**
	 * Bindings
	 * Bindings allow your Worker to interact with resources on the Cloudflare Developer Platform, including
	 * databases, object storage, AI inference, real-time communication and more.
	 * https://developers.cloudflare.com/workers/runtime-apis/bindings/
	 */
	/**
	 * Environment Variables
	 * https://developers.cloudflare.com/workers/wrangler/configuration/#environment-variables
	 */
	"vars": {
	  // Bridge URL for Claude Code server - default to localhost for development
	  "BRIDGE_URL": "http://localhost:8787/api/claude/stream",
	  // Optional: Path to MCP servers configuration (JSON string)
	  "MCP_CONFIG": "",
	  // Optional: Use AWS Bedrock instead of Anthropic API
	  "CLAUDE_CODE_USE_BEDROCK": "",
	  // Optional: Use Google Vertex AI instead of Anthropic API
	  "CLAUDE_CODE_USE_VERTEX": "",
	  // Public base URL for R2 assets (custom domain + bucket path prefix)
	  // Example: https://claude-r2.lakefrontdigital.io/user-assets
	  "R2_PUBLIC_BASE": "https://claude-r2.lakefrontdigital.io/user-assets"
	},
	/**
	 * Local Development Settings
	 * https://developers.cloudflare.com/workers/wrangler/configuration/#local-development-settings
	 */
	"dev": {
	  "port": 8788,
	  "inspector_port": 9330,
	  "local_protocol": "http"
	},
	"routes": [
		{ "pattern": "claude-worker.lakefrontdigital.io", "custom_domain": true }
	],
	"env": {
		"production": {
			"vars": {
				// Production Bridge URL via custom domain
				"BRIDGE_URL": "https://bridge.claude-workers.lakefrontdigital.io/api/claude/stream",
				// Optional: Path to MCP servers configuration (JSON string)
				"MCP_CONFIG": "",
				// Optional: Use AWS Bedrock instead of Anthropic API
				"CLAUDE_CODE_USE_BEDROCK": "",
				// Optional: Use Google Vertex AI instead of Anthropic API
				"CLAUDE_CODE_USE_VERTEX": "",
				// Public base URL for R2 assets (custom domain + bucket path prefix)
				"R2_PUBLIC_BASE": "https://claude-r2.lakefrontdigital.io/user-assets"
			},
			"routes": [
				{ "pattern": "claude-worker.lakefrontdigital.io", "custom_domain": true }
			],
			// Bind Secrets Store secrets for production environment as well
			"secrets_store_secrets": [
			  { "binding": "ANTHROPIC_API_KEY", "store_id": "18af881cb87f4ee289a7937973a8c8bc", "secret_name": "ANTHROPIC_API_KEY" },
			  { "binding": "TURNSTILE_SECRET", "store_id": "18af881cb87f4ee289a7937973a8c8bc", "secret_name": "TURNSTILE_SECRET" },
			  { "binding": "ACCESS_JWT_SECRET", "store_id": "18af881cb87f4ee289a7937973a8c8bc", "secret_name": "ACCESS_JWT_SECRET" }
			]
		}
	},
	/**
	 * Resource Bindings
	 * https://developers.cloudflare.com/workers/runtime-apis/bindings/
	 */
	"kv_namespaces": [
	  {
	    "binding": "sessions_kv",
	    "id": "4a4b6f01a56142f0b43803585276527a"
	  }
	],
	"d1_databases": [
	  {
	    "binding": "DB",
	    "database_name": "claude-code",
	    "database_id": "f2cac7b3-8b37-49e6-b347-fdc130d07381"
	  }
	],
	"r2_buckets": [
	  {
	    "binding": "FILES",
	    "bucket_name": "user-assets"
	  }
	],
	"durable_objects": {
	  "bindings": [
	    { "name": "SESSION", "class_name": "SessionDO" }
	  ]
	},
	"migrations": [
	  { "tag": "v1", "new_classes": ["SessionDO"] }
	],
	"queues": {
	  "producers": [
	    { "binding": "JOBS", "queue": "claude-code-jobs" }
	  ],
	  "consumers": [
	    { "queue": "claude-code-jobs" }
	  ]
	},
	// Bind org-level Secrets Store secrets to this Worker
	"secrets_store_secrets": [
	  { "binding": "ANTHROPIC_API_KEY", "store_id": "18af881cb87f4ee289a7937973a8c8bc", "secret_name": "ANTHROPIC_API_KEY" },
	  { "binding": "TURNSTILE_SECRET", "store_id": "18af881cb87f4ee289a7937973a8c8bc", "secret_name": "TURNSTILE_SECRET" },
	  { "binding": "ACCESS_JWT_SECRET", "store_id": "18af881cb87f4ee289a7937973a8c8bc", "secret_name": "ACCESS_JWT_SECRET" }
	],
	/**
	 * Secrets handling
	 * - Do NOT declare secrets in wrangler.jsonc (unsupported and insecure)
	 * - Local dev: use `.dev.vars` (already in repo) for values
	 * - Production: prefer Secrets Store bindings via `secrets_store_secrets` or use `wrangler secret put <NAME>`
	 * Docs: https://developers.cloudflare.com/workers/configuration/secrets/
	 */
	/**
	 * Static Assets
	 * https://developers.cloudflare.com/workers/static-assets/binding/
	 */
	// "assets": { "directory": "./public/", "binding": "ASSETS" }
	/**
	 * Service Bindings (communicate between multiple Workers)
	 * https://developers.cloudflare.com/workers/wrangler/configuration/#service-bindings
	 */
	// "services": [{ "binding": "MY_SERVICE", "service": "my-service" }]
}
