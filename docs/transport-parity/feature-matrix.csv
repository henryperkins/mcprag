Feature,stdio,HTTP,SSE,Parity,Notes,SpecRefs
Handshake version/capabilities,"JSONL handshake on connect","HTTP JSON handshake via endpoint/headers","SSE first event: handshake",Yes,"Common invariant across transports","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:399-414"
Unified token extraction,"auth_token param","Authorization: Bearer","Authorization header or ?token= fallback",Yes,"Use transport-agnostic extractor unify auth across transports","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:134-167; mcprag/auth/unified_auth_v2.py:49-87"
Tool registry parity,"register_tools()","register_tools()","register_tools()",Yes,"Single registry path avoids capability skew","mcprag/mcp/tools/__init__.py:16-46; docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:601-606"
Request envelope,"JSONL objects","HTTP JSON body","SSE data: JSON",Yes,"Same fields id,type,method,params,stream","docs/transport-parity/schemas (request/response/error)"
Streaming semantics,"JSONL frames","HTTP streaming/chunked JSON where supported","event: data lines with buffering off",Yes,"Ordered seq; terminal eos frame required","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:537-545"
Cancellation,"cancel message with id/streamId","/cancel endpoint or body flag","cancel event",Yes,"Server stops production promptly; client may observe final eos","docs/transport-parity/schemas (cancel)"
Ordering and de-dup,"seq strictly increasing","seq strictly increasing","seq strictly increasing",Yes,"Clients de-dup duplicates by seq","docs/transport-parity/schemas (stream.chunk)"
Authentication verification,"Stytch/M2M/Azure AD chain","Same verification chain","Same verification chain",Yes,"EnhancedStytchAuthenticator + M2M + Azure AD detection","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:172-240"
Proxy behavior (Authorization),"N/A","Standard proxying","Must forward Authorization; disable buffering",Partial,"Requires Nginx config to preserve headers and streaming","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:531-545"
Keepalive/heartbeat,"Periodic keepalive frames","Per-request timeout; optional server keepalive header","SSE keepalive events",Yes,"Keepalive message contract unified","docs/transport-parity/schemas (keepalive)"
Error taxonomy,"Typed codes","Typed codes","Typed codes",Yes,"Use ok()/err() helpers consistently","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:615-616; docs/transport-parity/schemas (error)"
Resume semantics,"resumeToken support","Header/body token","Query param or event",Yes,"Resume window policy; restart advice if invalid","docs/transport-parity/handshake-state-machine.txt:1"
MFA admin gating,"Decorator enforced","Decorator enforced","Decorator enforced",Yes,"REQUIRE_MFA_FOR_ADMIN gates ADMIN tier tools","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:333-365"
Component readiness,"Sync start before first request","Async startup scheduled with barrier","Async startup scheduled with barrier",Yes,"ensure async components started before tool use","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:403-414; 605-606"
Response truncation,"Truncation helpers applied","Truncation helpers applied","Truncation helpers applied",Yes,"Consistent trimming for large payloads","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:671-673; 607-608"
Azure Search client reuse,"Single instance reused","Single instance reused","Single instance reused",Yes,"Avoid duplicated clients; keep circuit breaker effective","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:614-616"
CORS/CSRF,"N/A","CORS + CSRF protections","CORS for SSE",Yes,"Deployment config must include Access-Control headers","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:545-550"
Rate limiting/flow control,"Advertise limits in caps","Advertise limits in caps","Advertise limits in caps",Yes,"Clients throttle on 429/Retry-After","docs/transport-parity/schemas (capabilities)"
Idempotent retry,"idempotent=true respected","idempotent=true respected","idempotent=true respected",Yes,"Duplicate id returns same result or AlreadyProcessed","docs/transport-parity/schemas (request/error)"
Binary attachments,"Base64 or signed URL","Base64 or signed URL","Base64 or signed URL",Yes,"Transport-agnostic handling","docs/transport-parity/schemas"
Versioning/feature gates,"Capability flags","Capability flags","Capability flags",Yes,"New features behind flags; default-off for older clients","docs/transport-parity/schemas (capabilities)"
Observability (logs/metrics/traces),"Same fields","Same fields","Same fields",Yes,"SessionId, requestId, tool, transport, tier, error.code, spans","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:655-662"
SSE timeouts,"N/A","Standard timeouts","Long read/send timeouts (24h)",Yes,"proxy_read/send_timeout 86400s; X-Accel-Buffering no","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:537-544"
Discovery endpoints (OAuth 2.1),"N/A",".well-known endpoints","Proxied to server",Yes,"RFC 9728 protected resource + AS metadata","docs/MCP_TRANSPORT_PARITY_GUIDE_V2.md:95-129"
Tool tier visibility,"list_tools filters by tier","list_tools filters by tier","list_tools filters by tier",Yes,"TransportWrapper.list_tools enforces tier visibility","docs/MCP_TRANSPORT_PARITY_GUIDE.md:188-205"