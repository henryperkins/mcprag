# How Claude Code Uses the search_codebase Tool

## Automatic Tool Discovery
When Claude Code starts up with the MCP server configured, it automatically discovers available tools. The `search_codebase` tool will appear in Claude's tool list.

## When Claude Uses search_codebase

Claude will automatically use the `search_codebase` tool when:

1. **You ask about code**: "Where is the authentication implemented?"
2. **You request changes**: "Update the login function to use JWT"
3. **You ask for understanding**: "How does the database connection work?"
4. **You need debugging help**: "Why is the API returning 404?"

## Prompting Tips for Better Search

To ensure Claude uses the search effectively:

### ✅ Good prompts:
- "Find where user authentication is handled"
- "Show me all database-related functions"
- "Where is the main API router defined?"
- "Find the error handling code"

### ❌ Avoid:
- Generic file requests: "Show me main.py" (use Read tool instead)
- Non-code queries: "What's the project structure?" (use LS tool)

## Search Intent Types

The MCP server supports different search intents:

- **understand**: Default mode for exploring code
- **implement**: When adding new features
- **debug**: When fixing issues
- **refactor**: When improving existing code

## Example Usage in Claude Code

```
You: "Help me understand how user authentication works in this codebase"

Claude: I'll search for authentication-related code...
[Uses search_codebase tool with query "authentication user login"]

Based on the search results, I found:
- Authentication is handled in `auth.py` with the `authenticate_user` function
- It uses JWT tokens generated by `AuthManager` class
- Password verification uses bcrypt hashing
...
```

## Verifying Tool Availability

To check if Claude has access to the tool:
1. Ask Claude: "What tools do you have available?"
2. Look for `search_codebase` in the list

## Troubleshooting

If Claude isn't using search_codebase:
1. Restart Claude Code
2. Check the MCP server logs: `tail -f ~/.config/claude-code/logs/mcp-*.log`
3. Verify the server is running: `ps aux | grep mcp_server_sota`
4. Test manually: `curl -X POST http://localhost:8002/mcp-query -H "Content-Type: application/json" -d '{"input": "test"}'`

## Indexing New Code

To index additional repositories:
```bash
cd /home/azureuser/mcprag
source venv/bin/activate
python smart_indexer.py --repo-path /path/to/repo --repo-name project-name
```

## Configuration Location

MCP configuration: `~/.config/claude-code/mcp-servers.json`